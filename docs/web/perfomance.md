# perfomance

[The Cost Of JavaScript In 2018](https://medium.com/@addyosmani/the-cost-of-javascript-in-2018-7d8950fbb5d4)
[Perfomance Checklist](https://www.smashingmagazine.com/2019/01/front-end-performance-checklist-2019-pdf-pages/)
[Системный подход к скорости](https://habr.com/ru/company/jugru/blog/426571)

## Подходы к оптимизации

Подходы:
1. Измерямость и сбор метрик
2. Производительность в вакууме

Три направления оптимизации:
- network connection, загрузка ресурсов
    - сетевые оптимизации
    - Меры по уменьшению размеров ресурсов: gzip, code spliting, lazy loading, кэширование в браузере
    - Кэширование и индексирование на сервере, индексы в бд
- rendering time. В зависимости от требований, но часто это избегание блокирующих ресурсов и задач блокирующих основной поток
- runtime. Часто сводиться к тому, чтобы не блокировать интерфейс

Особенно важно для мобильных: CPU

## Стадии рендеринга страницы

1. parsing 
2. формирование DOM и CSSOM
3. Render tree из DOM и CSSOM. Дерево содержит только видимые эл-ты
4. Layouting: вычисление лэйаута и геом св-в объектов
5. Painting: Отрисовка 

layout, painting and compositing

## События: 

- domLoading. Начальная отметка. В этот момент браузер начинает анализировать первые байты HTML- документа.
- domInteractive. В это время браузер завершил анализ документа и создал модель DOM.
- domContentLoaded. К этому моменту модели DOM и CSSOM уже готовы, поэтому ничто не мешает запуску скриптов JavaScript. Это значит, что браузер может приступать к созданию модели визуализации.
Если ваш фреймворк JavaScript запускается на этом этапе, вы можете отследить, как долго он выполняется, с помощью меток EventStart и EventEnd.
- domComplete. К этому моменту обработка завершена, а контент страницы (например, изображения) полностью скачан. Индикатор загрузки перестает вращаться.
- loadEvent. Сигнал полного завершения загрузки. Его можно использовать в качестве триггера функций и скриптов, добавив в HTML-код событие onload

## Repaint

В случае изменения стилей элемента, не влияющих на его размеры и положение на странице (например, background-color, border-color, visibility), браузер просто отрисовывает его заново, с учётом нового стиля — происходит repaint (или restyle).

## Reflow

Если же изменения затрагивают содержимое, структуру документа, положение элементов — происходит reflow (или relayout). Причинами таких изменений обычно являются:

- Манипуляции с DOM (добавление, удаление, изменение, перестановка элементов);
- Изменение содержимого, в т.ч. текста в полях форм;
- Расчёт или изменение CSS-свойств;
- Добавление, удаление таблиц стилей;
- Манипуляции с атрибутом «class»;
- Манипуляции с окном браузера — изменения размеров, прокрутка;
- Активация псевдо-классов (например, :hover).
