\#сети

# Протоколы верхнего уровня

С точки зрения, модели TCP/IP прикладной(верхний уровень) включает в себя три уровня по модели OSI: прикладной, представления и сеансовый.

Протоколы прикладного уровня обеспечивают взаимодействие между человеком и сетью. Их кол-во огормно как и их роли. С тз сетевика не важно, что происходит внутри прикладного уровня. Прикладной уровень - уроень работы  программистов.

## Протокол HTTP

**HTTP ** 
Использует "клиент-серверную" модель: существуют клиенты, которые формируют и отправляют запрос, И серверы, которые слушают запросы и, соответственно, на них отвечают. В качестве клиентов выступают веб-браузеры.

### Стуктура http запроса
```
GET / HTTP/1.1
Accept-Language: fr
Host: developer.mozilla.org
```

**Первая строка:** \<Method\> \<Path\> \<Version of protocol\>
**\<Method\>** - ключ запроса, определяет операцию, которую нужно осуществить с указанным ресурсом.
**\<Path\>** - URL Uniform Resource Locator, в примере '/' - корневая страница сайта
**\<Version of protocol\>** 

Все что ниже это заголовки(Headers), они опциональны. Позволяют отправить доп информацию на сервер.

Стукутра ответа

```
HTTP/1.1 200 OK

Date: Sat, 09 Oct 2010 14:28:02 GMT
Server: Apache
Last-Modified: Tue, 01 Dec 2009 20:18:22 GMT
ETag: "51142bc1-7449-479b075b2891b"
Accept-Ranges: bytes
Content-Length: 29769
Content-Type: text/html
...BODY
```

Первая строка: \<Version of protocol\> \<Status code\> \<Status message\>
Заголовки
BODY - опциональное тело ответа, содержит отправленный ресурс

### Расширение протокола

Протокол HTTP предполагает достаточно большое количество возможностей для расширения. В частности, спецификация HTTP 1.1 предполагает возможность использования заголовка Upgrade для переключения на обмен данными по другому протоколу. Запрос с таким заголовком отправляется клиентом. Если серверу требуется произвести переход на обмен данными по другому протоколу, то он может вернуть клиенту ответ со статусом «426 Upgrade Required», и в этом случае клиент может отправить новый запрос, уже с заголовком Upgrade.

Такая возможность используется, в частности, для организации обмена данными по протоколу WebSocket (протокол, позволяющий обеим сторонам передавать данные в нужный момент, без отправки дополнительных HTTP-запросов): стандартное «рукопожатие» (handshake) сводится к отправке HTTP-запроса с заголовком Upgrade, имеющим значение «websocket», на который сервер возвращает ответ с состоянием «101 Switching Protocols», и далее любая сторона может начать передавать данные уже по протоколу WebSocket.

### Методы протокола

1. **GET** запрос на представление указанного ресурса. GET-запросы должны только получать данные.

```
- Тело запроса - Нет
- Тело ответа - Да
- Безопасный - Да
- Идемпонетный - Да
- Кэш - Да
- Допускается в HTML-формах	- Да
```

2. **HEAD** - запрос на заголовки указанного ресурса, так если бы запрос был c методом GET на это ресурс.

Не должно быть тело, если имеется, то нужно его игнорировать. Также заголовки описывающие сущность ресурса будут относиться к хар-кам ресурса с методом GET.

```
- Тело запроса - Нет
- Тело ответа - Нет
- Безопасный - Да
- Идемпонетный - Да
- Кэш - Да
- Допускается в HTML-формах	- Нет
```

3. **POST** отправка данных на сервер, создание ресурса. Тип тела Header:Content-Type.

```
- Тело запроса - Да
- Тело ответа - Да
- Безопасный - Нет
- Идемпонетный - Нет
- Кэш - Может
- Допускается в HTML-формах	- Да
```

4. **PUT** - создание/замена ресурса. Разница между PUT и POST в том, что PUT является идемпотентным.

```
- Тело запроса - Да
- Тело ответа - Нет
- Безопасный - Нет
- Идемпонетный - Да
- Кэш - Нет
- Допускается в HTML-формах	- Нет
```

5. **DELETE** 

```
- Тело запроса - Может
- Тело ответа - Может
- Безопасный - Нет
- Идемпонетный - Да
- Кэш - Нет
- Допускается в HTML-формах	- Нет
```

5. **CONNECT** - устанавливает "туннель" к серверу, определённому по ресурсу.

6. **OPTIONS** используется для описания параметров соединения с ресурсом

7. **TRACE** выполняет вызов возвращаемого тестового сообщения с ресурса.
Возвращает полученный запрос так, что клиент может увидеть, какую информацию промежуточные серверы добавляют или изменяют в запросе.


8. **PATCH** используется для частичного изменения ресурса.

### Безопасный метод

Не меняет состояние сервера, проводит операции "только чтение" (read-only)

### Идемпонентность 
Свойство операции давать один и тот же результат на одни и те же входные данные.

**Источники**
- [https://m.habr.com/ru/post/307714/](https://m.habr.com/ru/post/307714/)
- [https://developer.mozilla.org/ru/docs/Web/HTTP/Methods](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods)
